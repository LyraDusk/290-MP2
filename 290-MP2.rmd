---
title: "MP2"
author: "Cara Krupnikoff-Salkin, Lauren Meyer, and Nicole Reardon"
date: "`r format(Sys.Date(), '%B %e, %Y')`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)

library(tidyverse)
library(car)
```


```{r data-cleaning, include = FALSE}
data <- read.csv('MP2_data.csv')

data <- data %>%
  select(choice, worthwhile, connect, waste, value, engage, attend, type, format) %>%
  filter(!row_number() %in% c(1, 2),
         !is.na(attend)) %>%
  mutate(choice = as.numeric(choice),
         worthwhile = as.numeric(worthwhile),
         connect = as.numeric(connect),
         waste = as.numeric(waste),
         value = as.numeric(value),
         engage = as.numeric(engage),
         attend = as.numeric(attend))

cleaned_data <- data %>%
  mutate(waste_recoded = 6 - waste,
         sum_eventscore = worthwhile + connect + waste_recoded + value + engage + attend,
         avg_eventscore = sum_eventscore / 6)
```


```{r analysis}
cleaned_data %>%
  group_by(type, format) %>%
  summarize(m = mean(avg_eventscore), sd = sd(avg_eventscore), n = n())

model1 <- lm(avg_eventscore ~ type*format, data = cleaned_data)
anova(model1)
#No significant differences. Not even when looking only at the virtual group, or only at the difference between the academic and business virtual groups. Alas. 

leveneTest(avg_eventscore ~ type * format, data = cleaned_data)
#Significant difference, invalid 

plot(model1, which = 1)
plot(model1, which = 2)

ggplot(cleaned_data, aes(x = type, y = avg_eventscore, color = format)) + 
  geom_point() + geom_jitter()
ggplot(cleaned_data, aes(x = type, y = avg_eventscore, fill = format)) + 
  geom_boxplot()
ggplot(cleaned_data, aes(x = format, y = avg_eventscore, fill = type)) + 
  geom_boxplot()
```

# Exploring Business
```{r}
cleaned_data %>%
  group_by(type) %>%
  summarize(n = n(),
            s = sd(choice),
            m = mean(choice))

mod_choice <- lm(choice ~ type * format, cleaned_data)
anova(mod)

no_business <- cleaned_data %>%
  filter(type != 'business')

mod_nobus <- lm(avg_eventscore ~ type*format, data = no_business)
anova(mod_nobus)

leveneTest(avg_eventscore ~ type * format, data = no_business)
# perhaps removing business makes the conditions for the model better
```

